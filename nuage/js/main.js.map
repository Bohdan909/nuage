{"version":3,"sources":["main.js"],"names":["jQuery","document","ready","$","productViewer","element","wrap","this","handleContainer","find","handleFill","children","handle","imageWrapper","slideShow","frames","data","friction","visibleFrame","loaded","animating","xPosition","loadFrames","transformElement","value","css","-moz-transform","-webkit-transform","-ms-transform","-o-transform","transform","prototype","self","imageUrl","newImg","loading","attr","load","remove","each","image","complete","trigger","percentage","setTimeout","addClass","dragImage","dragHandle","newPercentage","parseFloat","on","e","dragWidth","outerWidth","containerOffset","offset","left","containerWidth","minLeft","maxLeft","pageX","window","requestAnimationFrame","animateDraggedHandle","one","removeClass","off","preventDefault","leftValue","widthValue","Math","ceil","updateFrame","animateDraggedImage","updateHandle","frame","floor","newFrame","animate","transformValue"],"mappings":"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","file":"main.js","sourcesContent":["jQuery(document).ready(function($){\n\n\tvar productViewer = function(element, wrap) {\n\t\tthis.element = element;\n\t\tthis.handleContainer = this.element.find('.cd-product-viewer-handle');\n\t\tthis.handleFill = this.handleContainer.children('.fill');\n\t\tthis.handle = this.handleContainer.children('.handle');\n\t\tthis.imageWrapper = wrap;\n\t\tthis.slideShow = this.imageWrapper.find('.product-sprite');\n\t\tthis.frames = this.element.data('frame');\n\t\t//increase this value to increase the friction while dragging on the image - it has to be bigger than zero\n\t\tthis.friction = this.element.data('friction');\n\t\tthis.visibleFrame = 0;\n\t\tthis.loaded = false;\n\t\tthis.animating = false;\n\t\tthis.xPosition = 0;\n\t\tthis.loadFrames();\n\t} \n\n\tproductViewer.prototype.loadFrames = function() {\n\t\tvar self = this,\n\t\t\timageUrl = this.slideShow.data('image'),\n\t\t\tnewImg = $('<img/>');\n\t\tthis.loading('0.5');\n\t\t//you need this to check if the image sprite has been loaded\n\t\tnewImg.attr('src', imageUrl).load(function() {\n\t\t\t$(this).remove();\n  \t\t\tself.loaded = true;\n  \t\t}).each(function(){\n  \t\t\timage = this;\n\t\t\tif(image.complete) {\n\t\t    \t$(image).trigger('load');\n\t\t  \t}\n\t\t});\n\t}\n\n\tproductViewer.prototype.loading = function(percentage) {\n\t\tvar self = this;\n\t\ttransformElement(this.handleFill, 'scaleX('+ percentage +')');\n\t\tsetTimeout(function(){\n\t\t\tif( self.loaded ){\n\t\t\t\t//sprite image has been loaded\n\t\t\t\tself.element.addClass('loaded');\n\t\t\t\ttransformElement(self.handleFill, 'scaleX(1)');\n\t\t\t\tself.dragImage();\n\t\t\t\tif(self.handle) self.dragHandle();\n\t\t\t} else {\n\t\t\t\t//sprite image has not been loaded - increase self.handleFill scale value\n\t\t\t\tvar newPercentage = parseFloat(percentage) + .1;\n\t\t\t\tif ( newPercentage < 1 ) {\n\t\t\t\t\tself.loading(newPercentage);\n\t\t\t\t} else {\n\t\t\t\t\tself.loading(parseFloat(percentage));\n\t\t\t\t}\n\t\t\t}\n\t\t}, 500);\n\t}\n\t//draggable funtionality - credits to http://css-tricks.com/snippets/jquery/draggable-without-jquery-ui/\n\tproductViewer.prototype.dragHandle = function() {\n\t\t//implement handle draggability\n\t\tvar self = this;\n\t\tself.handle.on('mousedown vmousedown', function (e) {\n\t        self.handle.addClass('cd-draggable');\n\t        var dragWidth = self.handle.outerWidth(),\n\t            containerOffset = self.handleContainer.offset().left,\n\t            containerWidth = self.handleContainer.outerWidth(),\n\t            minLeft = containerOffset - dragWidth/2,\n\t            maxLeft = containerOffset + containerWidth - dragWidth/2;\n\n\t        self.xPosition = self.handle.offset().left + dragWidth - e.pageX;\n\n\t        self.element.on('mousemove vmousemove', function (e) {\n\n\t        \tif( !self.animating) {\n\t        \t\tself.animating =  true;\n\t\t        \t( !window.requestAnimationFrame )\n\t\t        \t\t? setTimeout(function(){self.animateDraggedHandle(e, dragWidth, containerOffset, containerWidth, minLeft, maxLeft);}, 100)\n\t\t        \t\t: requestAnimationFrame(function(){self.animateDraggedHandle(e, dragWidth, containerOffset, containerWidth, minLeft, maxLeft);});\n\t        \t}\n\t        }).one('mouseup vmouseup', function (e) {\n\t            self.handle.removeClass('cd-draggable');\n\t            self.element.off('mousemove vmousemove');\n\t        });\n\n\t        e.preventDefault();\n\n\t    }).on('mouseup vmouseup', function (e) {\n\t        self.handle.removeClass('cd-draggable');\n\t    });\n\t}\n\n\tproductViewer.prototype.animateDraggedHandle = function(e, dragWidth, containerOffset, containerWidth, minLeft, maxLeft) {\n\t\tvar self = this;\n\t\tvar leftValue = e.pageX + self.xPosition - dragWidth;\n\t    // constrain the draggable element to move inside his container\n\t    if (leftValue < minLeft) {\n\t        leftValue = minLeft;\n\t    } else if (leftValue > maxLeft) {\n\t        leftValue = maxLeft;\n\t    }\n\n\t    var widthValue = Math.ceil( (leftValue + dragWidth / 2 - containerOffset) * 1000 / containerWidth)/10;\n\t    self.visibleFrame = Math.ceil( (widthValue * (self.frames-1))/100 );\n\t\t\n\t    //update image frame\n\t    self.updateFrame();\n\t    //update handle position\n\t    $('.cd-draggable', self.handleContainer).css('left', widthValue + '%').one('mouseup vmouseup', function () {\n\t        $(this).removeClass('cd-draggable');\n\t    });\n\n\t    // Pos Drag\n\t    if (widthValue < 15 || widthValue > 85){\n\t    \t$(\".product-viewer-wrap\")\n\t\t    \t.removeClass(\"product-viewer-back\")\n\t\t    \t.addClass(\"product-viewer-front\");\n\t    } else if (widthValue > 46 && widthValue < 54){\n\t    \t$(\".product-viewer-wrap\")\n\t    \t\t.removeClass(\"product-viewer-front\")\n\t    \t\t.addClass(\"product-viewer-back\");\n\t    } else {\n\t    \t$(\".product-viewer-wrap\").removeClass(\"product-viewer-front product-viewer-back\");\n\t    }\n\n\t    self.animating = false;\n\t}\n\n\tproductViewer.prototype.dragImage = function() {\n\t\t//implement image draggability\n\t\tvar self = this;\n\t\tself.slideShow.on('mousedown vmousedown', function (e) {\n\t        self.slideShow.addClass('cd-draggable');\n\t        var containerOffset = self.imageWrapper.offset().left,\n\t            containerWidth = self.imageWrapper.outerWidth(),\n\t            minFrame = 0,\n\t            maxFrame = self.frames - 1;\n\n\t        self.xPosition = e.pageX;\n\n\t        self.element.on('mousemove vmousemove', function (e) {\n\t        \tif( !self.animating) {\n\t        \t\tself.animating = true;\n\t\t        \t( !window.requestAnimationFrame )\n\t\t        \t\t? setTimeout(function(){self.animateDraggedImage(e, containerOffset, containerWidth);}, 100)\n\t\t        \t\t: requestAnimationFrame(function(){self.animateDraggedImage(e, containerOffset, containerWidth);});\n\t\t        }\n\t        }).one('mouseup vmouseup', function (e) {\n\t            self.slideShow.removeClass('cd-draggable');\n\t            self.element.off('mousemove vmousemove');\n\t            self.updateHandle();\n\t        });\n\n\t        e.preventDefault();\n\n\t    }).on('mouseup vmouseup', function (e) {\n\t        self.slideShow.removeClass('cd-draggable');\n\t    });\n\t}\n\n\tproductViewer.prototype.animateDraggedImage = function(e, containerOffset, containerWidth) {\n\t\tvar self = this;\n\t\tvar leftValue = self.xPosition - e.pageX;\n        var widthValue = Math.ceil( (leftValue) * 100 / ( containerWidth * self.friction ));\n        var frame = (widthValue * (self.frames-1))/100;\n        if( frame > 0 ) {\n        \tframe = Math.floor(frame);\n        } else {\n        \tframe = Math.ceil(frame);\n        }\n        var newFrame = self.visibleFrame + frame;\n\n        if (newFrame < 0) {\n            newFrame = self.frames - 1;\n        } else if (newFrame > self.frames - 1) {\n            newFrame = 0;\n        }\n\n        if( newFrame != self.visibleFrame ) {\n        \tself.visibleFrame = newFrame;\n        \tself.updateFrame();\n        \tself.xPosition = e.pageX;\n        }\n\n        self.animating =  false;\n\t}\n\n\tproductViewer.prototype.updateHandle = function() {\n\t\tif(this.handle) {\n\t\t\tvar widthValue = 100*this.visibleFrame/this.frames;\n\t\t\tthis.handle.animate({'left': widthValue + '%'}, 200);\n\t\t}\n\t}\n\n\tproductViewer.prototype.updateFrame = function() {\n\t\tvar transformValue = - (100 * this.visibleFrame/this.frames);\n\t\ttransformElement(this.slideShow, 'translateX('+transformValue+'%)');\n\t}\n\n\tfunction transformElement(element, value) {\n\t\telement.css({\n\t\t\t'-moz-transform': value,\n\t\t    '-webkit-transform': value,\n\t\t\t'-ms-transform': value,\n\t\t\t'-o-transform': value,\n\t\t\t'transform': value,\n\t\t});\n\t}\n\n\tvar productToursWrapper = $('.cd-product-viewer-wrapper');\n\tproductToursWrapper.each(function(){\n\t\tnew productViewer($(this), $(\".product-view-wrap\"));\n\t});\n});"]}