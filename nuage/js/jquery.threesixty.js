!function(t,e,o,a){var n,r="threeSixty",i={dragDirection:"horizontal",useKeys:!1,draggable:!0},s=["horizontal","vertical"],d={},c={},l=[];function u(e,o){n=this,this.element=e,d=d=t.extend({},i,o),this._defaults=i,this._name=r,t.inArray(d.dragDirection,s)<0&&(d.dragDirection=i.dragDirection),this.init()}t.fn.destroy=u.prototype.destroy=function(){!0===d.useKeys&&t(o).unbind("keydown",this.onKeyDown),t(this).removeData(),c.html("")},t.fn.nextFrame=u.prototype.nextFrame=function(){t(this).each(function(e){var o=t(this),a=o.data("lastVal")||0,n=o.data("count");a+=1,o.data("lastVal",a),a>=n?a%=n-1:a<=-n&&(a%=n-1),a>0&&(a=n-a),a=Math.abs(a),o.find(".threesixty-frame").css({display:"none"}),o.find(".threesixty-frame:eq("+a+")").css({display:"block"})})},t.fn.prevFrame=u.prototype.prevFrame=function(){t(this).each(function(e){var o=t(this),a=o.data("lastVal")||0,n=o.data("count");a-=1,o.data("lastVal",a),a>=n?a%=n-1:a<=-n&&(a%=n-1),a>0&&(a=n-a),a=Math.abs(a),o.find(".threesixty-frame").css({display:"none"}),o.find(".threesixty-frame:eq("+a+")").css({display:"block"})})},u.prototype.init=function(){var e=t(this.element);c=e,e.each(function(){var e=t(this),o=e.data("path"),a=e.data("count");l.push({path:o,count:a,loaded:0,$el:e}),a}),g(),this.initLoad()},u.prototype.initLoad=function(){var e,o,a=0,n=l.length;for(c.addClass("preloading");a<n;a++)for(o=0;o<l[a].count;o++)e=l[a].path.replace("{index}",o),t("<img/>").data("index",a).attr("src",e).on("load",this.onLoadComplete)},u.prototype.onLoadComplete=function(e){var o=t(e.currentTarget).data("index"),a=l[o];a.loaded++,a.loaded===a.count&&n.onLoadAllComplete(o)},u.prototype.onLoadAllComplete=function(t){var e=l[t].$el,o="",a=l[t].count,n=l[t].path,r=0;for(e.html(""),e.removeClass("preloading");r<a;r++){o+='<img class="threesixty-frame" style="display:'+(0===r?"block":"none")+';" data-index="'+r+'" src="'+n.replace("{index}",r)+'"/>'}e.html(o),this.attachHandlers(t)};var h=0,p=null,f=0,y=0,v=0,m=!1;u.prototype.attachHandlers=function(e){var a=this,r=l[e].$el;if(d.draggable&&void 0!==o.ontouchstart&&void 0!==o.ontouchmove&&void 0!==o.ontouchend&&void 0!==o.ontouchcancel){var i=r.get()[0];i.addEventListener("touchstart",a.onTouchStart),i.addEventListener("touchmove",a.onTouchMove),i.addEventListener("touchend",a.onTouchEnd),i.addEventListener("touchcancel",a.onTouchEnd)}r.mousedown(function(e){e.preventDefault(),h=t(this).data("count"),p=t(this),e.screenY,v=p.data("lastVal")||0,y=p.data("lastX")||0,f=p.data("lastY")||0,m=!0,p.trigger("down")}),!0===d.useKeys&&t(o).bind("keydown",a.onKeyDown),t(o,"html","body").mouseup(a.onMouseUp),t(o).blur(a.onMouseUp),t("body").mousemove(function(t){a.onMove(t.screenX,t.screenY)}),t(".object-hover").on("mouseover",function(t){n.onMove(t.screenX,t.screenY)})},u.prototype.onTouchStart=function(e){var o=e.touches[0];e.preventDefault(),p=t(e.target).parent(),h=p.data("count"),startX=o.pageX,o.pageY,v=p.data("lastVal")||0,y=p.data("lastX")||0,f=p.data("lastY")||0,m=!0,p.trigger("down")},u.prototype.onTouchMove=function(t){t.preventDefault();var e=t.touches[0];n.onMove(e.pageX,e.pageY)},u.prototype.onTouchEnd=function(t){},u.prototype.onMove=function(t,e){if(m){var o=t,a=e,n=0;if(p.trigger("move"),"vertical"===d.dragDirection)n=a>f?v+1:v-1;else if(o>y)n=v+1;else{if(o===y)return;n=v-1}v=n,f=a,y=o,p.data("lastY",f),p.data("lastX",y),p.data("lastVal",v),n>=h?n%=h-1:n<=-h&&(n%=h-1),n>0&&(n=h-n),n=Math.abs(n),p.find(".threesixty-frame").css({display:"none"}),p.find(".threesixty-frame:eq("+n+")").css({display:"block"})}},u.prototype.onKeyDown=function(t){switch(t.keyCode){case 37:c.prevFrame();break;case 39:c.nextFrame()}},u.prototype.onMouseUp=function(t){m=!1,p.trigger("up")};var g=function(){o.body.onselectstart=function(){return!1},o.body.ondragstart=function(){return!1}};t.fn[r]=function(e){return this.each(function(){t.data(this,"plugin_"+r)||t.data(this,"plugin_"+r,new u(this,e))})}}(jQuery,window,document);
//# sourceMappingURL=jquery.threesixty.js.map
