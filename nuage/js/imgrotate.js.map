{"version":3,"sources":["imgrotate.js"],"names":["rotatingImageError","rotError","useThrow","name","message","description","eval","alert","getRotPositionFromEvent","mousEvent","pageX","pageY","startX","clientX","startY","clientY","document","documentElement","scrollLeft","scrollTop","body","RotatingImage","imgPrefix","imgExt","imgName","numRot","numTilt","curRot","curTilt","progressScript","oReadyScript","this","startAutoRot","prototype","doneImages","isNaN","parseInt","rotInterval","tiltInterval","pausedX","pausedY","preloadComplete","imagesLoaded","imageCache","rotref","i","j","Image","onload","theImage","alreadyload","onerror","src","complete","redraw","image","images","startAutoTilt","oTime","oStartDir","oOb","stopAutoTilt","tiltDirection","setInterval","tiltUp","tiltDown","clearInterval","oDir","stopAutoRot","rotDirection","rotateUp","rotateDown","tiltTo","oTilt","oAllow","rotateTo","oRot","setPanning","oX","oY","oStopX","oStopY","onmousedown","style","cursor","ondragstart","onselectstart","e","window","event","button","which","curtRot","curtTilt","startPos","oldmouseup","onmouseup","curSegs","onmousemove","newSegs","width","height","mousePos","Math","round","setupZoomInformation","rotZoomDetails","zoom","zoomImageIn","byPercent","maxPercent","desiredPercent","zoomImageTo","zoomImageOut","minPercent","toPercent","getTilt","getNumTilt","getRotation","getNumRotation"],"mappings":"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","file":"imgrotate.js","sourcesContent":["/**********************************************************************\r\n                         3D image rotating script\r\n                    By Mark Wilton-Jones 04-05/1/2007\r\n                               Version 1.0\r\n***********************************************************************\r\n\r\nPlease see http://www.howtocreate.co.uk/jslibs/ for details and a demo of this script\r\nPlease see http://www.howtocreate.co.uk/tutorials/jsexamples/imagerotate.html for configuration instructions\r\nPlease see http://www.howtocreate.co.uk/jslibs/termsOfUse.html for terms of use\r\n\r\n________________________________________________________________________________*/\r\n\r\nfunction rotatingImageError(rotError,useThrow) {\r\n    rotError = { name: 'RotatingImage error', message: rotError, description: rotError };\r\n    if( useThrow ) { eval('throw(rotError)'); } else { alert( rotError.name + ': ' + rotError.message ); }\r\n}\r\n\r\nfunction getRotPositionFromEvent(mousEvent) {\r\n    if( typeof( mousEvent.pageX ) != 'undefined' ) {\r\n        return [mousEvent.pageX,mousEvent.pageY];\r\n    } else {\r\n        var startX = mousEvent.clientX, startY = mousEvent.clientY;\r\n        if( document.documentElement && ( document.documentElement.scrollLeft || document.documentElement.scrollTop ) ) {\r\n            return [startX+document.documentElement.scrollLeft,startY+document.documentElement.scrollTop];\r\n        } else {\r\n            return [startX+document.body.scrollLeft,startY+document.body.scrollTop];\r\n        }\r\n    }\r\n}\r\n\r\nfunction RotatingImage( imgPrefix, imgExt, imgName, numRot, numTilt, curRot, curTilt, progressScript, oReadyScript, useThrow ) {\r\n\r\n    //check for errors\r\n    var rotError = '';\r\n    if( !this.startAutoRot ) { rotError += '\\n* Use the \\'new\\' keyword when calling the RotatingImage function.'; }\r\n    if( typeof(imgPrefix) != 'string' ) { rotError += '\\n* Image prefix must be a string.'; }\r\n    if( typeof(imgExt) != 'string' ) { rotError += '\\n* Image extension must be a string.'; }\r\n    if( typeof(imgName) != 'string' ) { rotError += '\\n* Image name must be a string.'; }\r\n    if( RotatingImage.prototype.doneImages[imgName] ) { rotError += '\\n* Image name'+imgName+' has already been set up ready to rotate. This cannot be done twice for a single image.'; }\r\n    if( isNaN(numRot) || numRot < 1 || parseInt(numRot) != numRot ) { rotError += '\\n* Number of images in the rotation must be a whole number >= 1.'; }\r\n    if( isNaN(numTilt) || numTilt < 1 || parseInt(numTilt) != numTilt ) { rotError += '\\n* Number of tilt angles must be a whole number >= 1.'; }\r\n    if( isNaN(curRot) || curRot < 1 || curRot > numRot || parseInt(curRot) != curRot ) { rotError += '\\n* Current rotation must be a whole number between 1 and the number of images in the rotation.'; }\r\n    if( isNaN(curTilt) || curTilt < 1 || curTilt > numTilt || parseInt(curTilt) != curTilt ) { rotError += '\\n* Current tilt must be a whole number between 1 and the number of tilt angles.'; }\r\n    if( rotError ) { rotatingImageError(rotError,useThrow); return; }\r\n    RotatingImage.prototype.doneImages[imgName] = true;\r\n\r\n    //store values\r\n    this.imgPrefix = imgPrefix;\r\n    this.imgExt = imgExt;\r\n    this.imgName = imgName;\r\n    this.numRot = numRot;\r\n    this.numTilt = numTilt;\r\n    this.curRot = curRot;\r\n    this.curTilt = curTilt;\r\n    this.useThrow = useThrow;\r\n\r\n    //prepare automation\r\n    this.rotInterval = 0;\r\n    this.tiltInterval = 0;\r\n    this.pausedX = false;\r\n    this.pausedY = false;\r\n\r\n    //begin preloading required images - this could take a while :)\r\n    this.preloadComplete = false;\r\n    this.imagesLoaded = 0;\r\n    this.imageCache = [];\r\n    var rotref = this;\r\n    for( var i = 1; i <= numRot; i++ ) {\r\n        this.imageCache[i] = [];\r\n        for( var j = 1; j <= numTilt; j++ ) {\r\n            //index 0 is unused in both array levels\r\n            //this is harmless but makes it easier to use later without having to add and subtract 1 (so it is more efficient)\r\n            this.imageCache[i][j] = new Image();\r\n            this.imageCache[i][j].onload = (function (theImage) { return function () {\r\n                if( theImage.alreadyload ) { return; }\r\n                theImage.alreadyload = true;\r\n                rotref.imagesLoaded++;\r\n                if( progressScript ) { progressScript( rotref.imagesLoaded / ( rotref.numRot * rotref.numTilt ) ); }\r\n                if( rotref.imagesLoaded == rotref.numRot * rotref.numTilt ) {\r\n                    if( oReadyScript ) { oReadyScript(); }\r\n                    rotref.preloadComplete = true;\r\n                }\r\n            }; })(this.imageCache[i][j]); //workaround for Safari stupidity ('this' points to window)\r\n            this.imageCache[i][j].onerror = function () { this.onload(); };\r\n            this.imageCache[i][j].src = this.imgPrefix + '_' + i + '_' + j + this.imgExt;\r\n            if( this.imageCache[i][j].complete ) { this.imageCache[i][j].onload(); }\r\n        }\r\n    }\r\n}\r\nRotatingImage.prototype.doneImages = {};\r\n\r\n//general redraw\r\nRotatingImage.prototype.redraw = function () {\r\n    if( !this.image ) { this.image = document.images[this.imgName]; if( !this.image ) { return; } }\r\n    this.image.src = this.imageCache[this.curRot][this.curTilt].src;\r\n};\r\n\r\n//automation\r\nRotatingImage.prototype.startAutoTilt = function (oTime,oStartDir) {\r\n    var oOb = this;\r\n    if( this.numTilt < 2 ) {\r\n        rotatingImageError('AutoTilt can only be used if more than one tilt angles are being used.',this.useThrow); return;\r\n    }\r\n    if( isNaN(oTime) || oTime < 10 || parseInt(oTime) != oTime ) {\r\n        rotatingImageError('AutoTilt needs to be passed an integer greater than 10 to use as the stepping interval.',this.useThrow); return;\r\n    }\r\n    this.stopAutoTilt();\r\n    this.tiltDirection = oStartDir;\r\n    this.tiltInterval = setInterval(function () {\r\n        if( oOb.preloadComplete && !oOb.pausedY && ( oOb.image || document.images[oOb.imgName] ) ) {\r\n            if( oOb.tiltDirection && oOb.curTilt == oOb.numTilt ) { oOb.tiltDirection = false; }\r\n            if( !oOb.tiltDirection && oOb.curTilt == 1 ) { oOb.tiltDirection = true; }\r\n            if( oOb.tiltDirection ) { oOb.tiltUp(true); } else { oOb.tiltDown(true); }\r\n        }\r\n    },oTime);\r\n};\r\nRotatingImage.prototype.stopAutoTilt = function () {\r\n    if( this.tiltInterval ) {\r\n        clearInterval(this.tiltInterval);\r\n        this.tiltInterval = 0;\r\n    }\r\n};\r\nRotatingImage.prototype.startAutoRot = function (oTime,oDir) {\r\n    var oOb = this;\r\n    if( isNaN(oTime) || oTime < 10 || parseInt(oTime) != oTime ) {\r\n        rotatingImageError('AutoRotate needs to be passed an integer greater than 10 to use as the stepping interval.',this.useThrow); return;\r\n    }\r\n    this.stopAutoRot();\r\n    this.rotDirection = oDir;\r\n    this.rotInterval = setInterval(function () {\r\n        if( oOb.preloadComplete && !oOb.pausedX && ( oOb.image || document.images[oOb.imgName] ) ) {\r\n            if( oOb.rotDirection ) { oOb.rotateUp(true); } else { oOb.rotateDown(true); }\r\n        }\r\n    },oTime);\r\n};\r\nRotatingImage.prototype.stopAutoRot = function () {\r\n    if( this.rotInterval ) {\r\n        clearInterval(this.rotInterval);\r\n        this.rotInterval = 0;\r\n    }\r\n};\r\n\r\n//individual tilt/rotation\r\nRotatingImage.prototype.tiltTo = function (oTilt,oAllow) {\r\n    if( !oAllow ) { this.stopAutoTilt(); }\r\n    if( isNaN(oTilt) || oTilt < 1 || oTilt > this.numTilt || parseInt(oTilt) != oTilt ) {\r\n        rotatingImageError('tiltTo number must be a whole number between 1 and the number of tilt angles.',this.useThrow); return;\r\n    }\r\n    this.curTilt = oTilt;\r\n    this.redraw();\r\n};\r\nRotatingImage.prototype.tiltUp = function (oAllow) {\r\n    if( !oAllow ) { this.stopAutoTilt(); }\r\n    if( this.curTilt < this.numTilt ) {\r\n        this.curTilt++;\r\n        this.redraw();\r\n    }\r\n};\r\nRotatingImage.prototype.tiltDown = function (oAllow) {\r\n    if( !oAllow ) { this.stopAutoTilt(); }\r\n    if( this.curTilt > 1 ) {\r\n        this.curTilt--;\r\n        this.redraw();\r\n    }\r\n};\r\nRotatingImage.prototype.rotateTo = function (oRot,oAllow) {\r\n    if( !oAllow ) { this.stopAutoRot(); }\r\n    if( isNaN(oRot) || oRot < 1 || oRot > this.numRot || parseInt(oRot) != oRot ) {\r\n        rotatingImageError('rotateTo number must be a whole number between 1 and the number of images in the rotation.',this.useThrow); return;\r\n    }\r\n    this.curRot = oRot;\r\n    this.redraw();\r\n};\r\nRotatingImage.prototype.rotateUp = function (oAllow) {\r\n    if( !oAllow ) { this.stopAutoRot(); }\r\n    this.curRot++;\r\n    if( this.curRot > this.numRot ) { this.curRot = 1; }\r\n    this.redraw();\r\n};\r\nRotatingImage.prototype.rotateDown = function (oAllow) {\r\n    if( !oAllow ) { this.stopAutoRot(); }\r\n    this.curRot--;\r\n    if( !this.curRot ) { this.curRot = this.numRot; }\r\n    this.redraw();\r\n};\r\n\r\n//panning\r\nRotatingImage.prototype.setPanning = function (oX,oY,oStopX,oStopY) {\r\n    var oOb = this;\r\n    if( !this.image ) { this.image = document.images[this.imgName]; if( !this.image ) {\r\n        rotatingImageError('Panning cannot be allowed until after the image has been created.',this.useThrow); return;\r\n    } }\r\n    if( !oX && !oY ) {\r\n        this.image.onmousedown = null;\r\n        if( this.image.style ) { this.image.style.cursor = ''; }\r\n        return;\r\n    }\r\n    if( this.image.style ) { this.image.style.cursor = 'move'; }\r\n    this.image.ondragstart = function () { return false; }\r\n    this.image.onselectstart = function () { return false; }\r\n    this.image.onmousedown = function (e) {\r\n        if( !e ) { e = window.event; } if( !e ) { return true; }\r\n        if( e.button > 1 || e.which > 1 ) { return true; }\r\n        var startRotImg = oOb.curtRot, startTiltImg = oOb.curtTilt, startPos = getRotPositionFromEvent(e), oldmouseup = document.onmouseup, curSegs = [0,0];\r\n        this.onmousemove = function (e) {\r\n            if( !e ) { e = window.event; }\r\n            var newSegs = [ this.width / ( oOb.numRot / 2 ), this.height / oOb.numTilt ];\r\n            var mousePos = getRotPositionFromEvent(e);\r\n            newSegs[2] = newSegs[0] = Math.round( ( mousePos[0] - startPos[0] ) / newSegs[0] );\r\n            newSegs[3] = newSegs[1] = Math.round( ( mousePos[1] - startPos[1] ) / newSegs[1] );\r\n            if( oX ) {\r\n                if( oStopX ) { oOb.stopAutoRot(); }\r\n                oOb.pausedX = true;\r\n                while( newSegs[0] > curSegs[0] ) { oOb.rotateDown(!oStopX); newSegs[0]--; }\r\n                while( newSegs[0] < curSegs[0] ) { oOb.rotateUp(!oStopX); newSegs[0]++; }\r\n            }\r\n            if( oY ) {\r\n                if( oStopY ) { oOb.stopAutoTilt(); }\r\n                oOb.pausedY = true;\r\n                while( newSegs[1] > curSegs[1] ) { oOb.tiltDown(!oStopY); newSegs[1]--; }\r\n                while( newSegs[1] < curSegs[1] ) { oOb.tiltUp(!oStopY); newSegs[1]++; }\r\n            }\r\n            curSegs = [newSegs[2],newSegs[3]];\r\n        };\r\n        document.onmouseup = function () {\r\n            oOb.pausedX = false;\r\n            oOb.pausedY = false;\r\n            oOb.image.onmousemove = null;\r\n            document.onmouseup = oldmouseup;\r\n        };\r\n        return false;\r\n    };\r\n};\r\n\r\n//zooming\r\nRotatingImage.prototype.setupZoomInformation = function() { if( !this.image ) { this.image = document.images[this.imgName]; if( !this.image ) {\r\n        rotatingImageError('Images cannot be zoomed until after they have been created.',this.useThrow); return;\r\n    } }\r\n    if( !this.rotZoomDetails ) {\r\n        if( !this.image.height && !this.image.width ) {\r\n            rotatingImageError('Images cannot be zoomed until after they have loaded.',this.useThrow); return;\r\n        }\r\n        this.rotZoomDetails = { height: this.image.height, width: this.image.width, zoom: 100 };\r\n    }\r\n}\r\nRotatingImage.prototype.zoomImageIn = function (byPercent,maxPercent) {\r\n    this.setupZoomInformation();\r\n    if( !this.rotZoomDetails ) { return 0; }\r\n    var desiredPercent = this.rotZoomDetails.zoom + byPercent;\r\n    if( desiredPercent > maxPercent ) { desiredPercent = maxPercent; }\r\n    this.zoomImageTo(desiredPercent);\r\n    return desiredPercent;\r\n}\r\nRotatingImage.prototype.zoomImageOut = function (byPercent,minPercent) {\r\n    this.setupZoomInformation();\r\n    if( !this.rotZoomDetails ) { return 0; }\r\n    var desiredPercent = this.rotZoomDetails.zoom - byPercent;\r\n    if( desiredPercent < minPercent ) { desiredPercent = minPercent; }\r\n    this.zoomImageTo(desiredPercent);\r\n    return desiredPercent;\r\n}\r\nRotatingImage.prototype.zoomImageTo = function (toPercent) {\r\n    this.setupZoomInformation();\r\n    if( !this.rotZoomDetails ) { return; }\r\n    if( isNaN(toPercent) || toPercent < 0 ) { rotatingImageError('A positive number must be used when zooming.',this.useThrow); return; }\r\n    this.image.height = Math.round( this.rotZoomDetails.height * ( toPercent / 100 ) );\r\n    this.image.width = Math.round( this.rotZoomDetails.width * ( toPercent / 100 ) );\r\n    this.rotZoomDetails.zoom = toPercent;\r\n}\r\n\r\n//simulated read-only properties\r\nRotatingImage.prototype.getTilt = function () { return this.curTilt; };\r\nRotatingImage.prototype.getNumTilt = function () { return this.numTilt; };\r\nRotatingImage.prototype.getRotation = function () { return this.curRot; };\r\nRotatingImage.prototype.getNumRotation = function () { return this.numRot; };"]}