{"version":3,"sources":["jquery.threesixty.js"],"names":["$","window","document","undefined","scope","pluginName","defaults","dragDirection","useKeys","draggable","dragDirections","options","$el","data","ThreeSixty","element","customOptions","this","extend","_defaults","_name","inArray","init","fn","destroy","prototype","unbind","onKeyDown","removeData","html","nextFrame","each","i","$this","val","thisTotal","Math","abs","find","css","display","prevFrame","path","count","push","loaded","_disableTextSelectAndDragIE8","initLoad","url","j","len","length","addClass","replace","attr","on","onLoadComplete","e","index","currentTarget","thisObj","onLoadAllComplete","objIndex","l","pathTemplate","removeClass","attachHandlers","$downElem","lastY","lastX","lastVal","isMouseDown","that","ontouchstart","ontouchmove","ontouchend","ontouchcancel","elem","get","addEventListener","onTouchStart","onTouchMove","onTouchEnd","mousedown","preventDefault","screenY","trigger","bind","mouseup","onMouseUp","blur","mousemove","onMove","screenX","touch","touches","target","parent","startX","pageX","pageY","x","y","keyCode","body","onselectstart","ondragstart","jQuery"],"mappings":"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","file":"jquery.threesixty.js","sourcesContent":["/*!\n * ThreeSixty: A jQuery plugin for generating a draggable 360 preview from an image sequence.\n * Version: 0.1.2\n * Original author: @nick-jonas\n * Website: http://www.workofjonas.com\n * Licensed under the MIT license\n */\n\n;(function ( $, window, document, undefined ) {\n\n\nvar scope,\n    pluginName = 'threeSixty',\n    defaults = {\n        dragDirection: 'horizontal',\n        useKeys: false,\n        draggable: true\n    },\n    dragDirections = ['horizontal', 'vertical'],\n    options = {},\n    $el = {},\n    data = [],\n    total = 0,\n    loaded = 0;\n\n    /**\n     * Constructor\n     * @param {jQuery Object} element       main jQuery object\n     * @param {Object} customOptions        options to override defaults\n     */\n    function ThreeSixty( element, customOptions ) {\n        scope = this;\n        this.element = element;\n        options = options = $.extend( {}, defaults, customOptions) ;\n        this._defaults = defaults;\n        this._name = pluginName;\n\n        // make sure string input for drag direction is valid\n        if($.inArray(options.dragDirection, dragDirections) < 0){\n            options.dragDirection = defaults.dragDirection;\n        }\n\n        this.init();\n    }\n\n    // PUBLIC API -----------------------------------------------------\n\n    $.fn.destroy = ThreeSixty.prototype.destroy = function(){\n        if(options.useKeys === true) $(document).unbind('keydown', this.onKeyDown);\n        $(this).removeData();\n        $el.html('');\n    };\n\n    $.fn.nextFrame = ThreeSixty.prototype.nextFrame = function(){\n        $(this).each(function(i){\n            var $this = $(this),\n                val = $this.data('lastVal') || 0,\n                thisTotal = $this.data('count');\n\n            val = val + 1;\n\n            $this.data('lastVal', val);\n\n            if(val >= thisTotal) val = val % (thisTotal - 1);\n            else if(val <= -thisTotal) val = val % (thisTotal - 1);\n            if(val > 0) val = thisTotal - val;\n\n            val = Math.abs(val);\n\n            $this.find('.threesixty-frame').css({display: 'none'});\n            $this.find('.threesixty-frame:eq(' + val + ')').css({display: 'block'});\n        });\n    };\n\n    $.fn.prevFrame = ThreeSixty.prototype.prevFrame = function(){\n        $(this).each(function(i){\n            var $this = $(this),\n                val = $this.data('lastVal') || 0,\n                thisTotal = $this.data('count');\n\n            val = val - 1;\n\n            $this.data('lastVal', val);\n\n            if(val >= thisTotal) val = val % (thisTotal - 1);\n            else if(val <= -thisTotal) val = val % (thisTotal - 1);\n            if(val > 0) val = thisTotal - val;\n\n            val = Math.abs(val);\n\n            $this.find('.threesixty-frame').css({display: 'none'});\n            $this.find('.threesixty-frame:eq(' + val + ')').css({display: 'block'});\n        });\n    };\n\n\n\n    // PRIVATE METHODS -------------------------------------------------\n\n    /**\n     * Initializiation, called once from constructor\n     * @return null\n     */\n    ThreeSixty.prototype.init = function () {\n        var $this = $(this.element);\n\n        // setup main container\n        $el = $this;\n\n        // store data attributes for each 360\n        $this.each(function(){\n            var $this = $(this),\n                path = $this.data('path'),\n                count = $this.data('count');\n            data.push({'path': path, 'count': count, 'loaded': 0, '$el': $this});\n            total += count;\n        });\n\n        _disableTextSelectAndDragIE8();\n\n        this.initLoad();\n    };\n\n    /**\n     * Start loading all images\n     * @return null\n     */\n    ThreeSixty.prototype.initLoad = function() {\n        var i = 0, len = data.length, url, j;\n        $el.addClass('preloading');\n        for(i; i < len; i++){\n            j = 0;\n            for(j; j < data[i].count; j++){\n                url = data[i].path.replace('{index}', j);\n                $('<img/>').data('index', i).attr('src', url).on(\"load\", this.onLoadComplete);\n            }\n        }\n    };\n\n    ThreeSixty.prototype.onLoadComplete = function(e) {\n        var index = $(e.currentTarget).data('index'),\n            thisObj = data[index];\n        thisObj.loaded++;\n        if(thisObj.loaded === thisObj.count){\n            scope.onLoadAllComplete(index);\n        }\n    };\n\n    ThreeSixty.prototype.onLoadAllComplete = function(objIndex) {\n        var $this = data[objIndex].$el,\n            html = '',\n            l = data[objIndex].count,\n            pathTemplate = data[objIndex].path,\n            i = 0;\n\n        // remove preloader\n        $this.html('');\n        $this.removeClass('preloading');\n\n        // add 360 images\n        for(i; i < l; i++){\n            var display = (i === 0) ? 'block' : 'none';\n            html += '<img class=\"threesixty-frame\" style=\"display:' + display + ';\" data-index=\"' + i + '\" src=\"' + pathTemplate.replace('{index}', i) + '\"/>';\n        }\n        $this.html(html);\n\n        this.attachHandlers(objIndex);\n    };\n\n    var startY = 0,\n        thisTotal = 0,\n        $downElem = null,\n        lastY = 0,\n        lastX = 0,\n        lastVal = 0,\n        isMouseDown = false;\n\n    ThreeSixty.prototype.attachHandlers = function(objIndex) {\n        var that = this;\n        var $this = data[objIndex].$el;\n\n        // add draggable events\n        if(options.draggable){\n            // if touch events supported, use\n            if(typeof document.ontouchstart !== 'undefined' &&\n                typeof document.ontouchmove !== 'undefined' &&\n                typeof document.ontouchend !== 'undefined' &&\n                typeof document.ontouchcancel !== 'undefined'){\n                var elem = $this.get()[0];\n                elem.addEventListener('touchstart', that.onTouchStart);\n                elem.addEventListener('touchmove', that.onTouchMove);\n                elem.addEventListener('touchend', that.onTouchEnd);\n                elem.addEventListener('touchcancel', that.onTouchEnd);\n            }\n        }\n\n        // mouse down\n        $this.mousedown(function(e){\n            e.preventDefault();\n            thisTotal = $(this).data('count');\n            $downElem = $(this);\n            startY = e.screenY;\n            lastVal = $downElem.data('lastVal') || 0;\n            lastX = $downElem.data('lastX') || 0;\n            lastY = $downElem.data('lastY') || 0;\n            isMouseDown = true;\n            $downElem.trigger('down');\n        });\n\n        // arrow keys\n        if(options.useKeys === true){\n            $(document).bind('keydown', that.onKeyDown);\n        }\n\n        // mouse up\n        $(document, 'html', 'body').mouseup(that.onMouseUp);\n        $(document).blur(that.onMouseUp);\n        $('body').mousemove(function(e){\n            that.onMove(e.screenX, e.screenY);\n        });\n\n        $(\".object-hover\").on(\"mouseover\", function(e){\n            scope.onMove(e.screenX, e.screenY);\n            \n        });\n    };\n\n    ThreeSixty.prototype.onTouchStart = function(e) {\n        var touch = e.touches[0];\n        e.preventDefault();\n        $downElem = $(e.target).parent();\n        thisTotal = $downElem.data('count');\n        startX = touch.pageX;\n        startY = touch.pageY;\n        lastVal = $downElem.data('lastVal') || 0;\n        lastX = $downElem.data('lastX') || 0;\n        lastY = $downElem.data('lastY') || 0;\n        isMouseDown = true;\n        $downElem.trigger('down');\n    };\n\n    ThreeSixty.prototype.onTouchMove = function(e) {\n        e.preventDefault();\n        var touch = e.touches[0];\n        scope.onMove(touch.pageX, touch.pageY);\n    };\n\n    ThreeSixty.prototype.onTouchEnd = function(e) {\n\n    };\n\n    ThreeSixty.prototype.onMove = function(screenX, screenY){\n        if(isMouseDown){\n            var x = screenX,\n                y = screenY,\n                val = 0;\n\n            $downElem.trigger('move');\n\n            if(options.dragDirection === 'vertical'){\n                if(y > lastY){\n                    val = lastVal + 1;\n                }else{\n                    val = lastVal - 1;\n                }\n            }else{\n                if(x > lastX){\n                    val = lastVal + 1;\n                }else if(x === lastX){\n                    return;\n                }else{\n                    val = lastVal - 1;\n                }\n            }\n\n            lastVal = val;\n            lastY = y;\n            lastX = x;\n\n            $downElem.data('lastY', lastY);\n            $downElem.data('lastX', lastX);\n            $downElem.data('lastVal', lastVal);\n\n            if(val >= thisTotal) val = val % (thisTotal - 1);\n            else if(val <= -thisTotal) val = val % (thisTotal - 1);\n            if(val > 0) val = thisTotal - val;\n\n            val = Math.abs(val);\n\n            $downElem.find('.threesixty-frame').css({display: 'none'});\n            $downElem.find('.threesixty-frame:eq(' + val + ')').css({display: 'block'});\n        }\n    };\n\n    ThreeSixty.prototype.onKeyDown = function(e) {\n        switch(e.keyCode){\n            case 37: // left\n                $el.prevFrame();\n                break;\n            case 39: // right\n                $el.nextFrame();\n                break;\n        }\n    };\n\n    ThreeSixty.prototype.onMouseUp = function(e) {\n        isMouseDown = false;\n        $downElem.trigger('up');\n    };\n\n    /**\n     * Disables text selection and dragging on IE8 and below.\n     */\n    var _disableTextSelectAndDragIE8 = function() {\n      // Disable text selection.\n      document.body.onselectstart = function() {\n          return false;\n      };\n\n      // Disable dragging.\n      document.body.ondragstart = function() {\n          return false;\n      };\n    };\n\n\n    /**\n     * A really lightweight plugin wrapper around the constructor,\n        preventing against multiple instantiations\n     * @param  {Object} options\n     * @return {jQuery Object}\n     */\n    $.fn[pluginName] = function ( options ) {\n        return this.each(function () {\n            if (!$.data(this, 'plugin_' + pluginName)) {\n                $.data(this, 'plugin_' + pluginName,\n                new ThreeSixty( this, options ));\n            }\n        });\n    };\n\n})( jQuery, window, document );\n\n\n\n"]}